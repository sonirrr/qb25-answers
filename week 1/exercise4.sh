#!/bin/bash

bedtools intersect -c -a hg19-kc.bed -b snps-chr1.bed | sort -r -k5 | head
#returns this:
#chr1	23037331	23247993	ENST00000374630.8_7	995
#chr1	247108848	247242038	ENST00000465049.6_8	993
#chr1	92145899	92351708	ENST00000212355.9_11	992
#chr1	83368865	83632498	ENST00000452901.5_3	992
#chr1	88751141	88776966	ENST00000737208.1_2	99
#chr1	87794562	87814606	ENST00000370544.10_4	99
#chr1	36235694	36272545	ENST00000786197.1_1	99
#chr1	29063451	29096287	ENST00000373812.8_8	99
#chr1	233086356	233119628	ENST00000366628.10_4	99
#chr1	173384836	173409596	ENST00000778987.1_2	99

#the gene with the most SNPs on chromosome 1 is ENST00000374630.8_7
#human readable name: EPHB2
#position: hg19 chr1:23,037,463-23,240,763
#size: 203,301
#exon count: 16

#this gene has the most SNPs because of its function??

bedtools sample -n 20 -seed 42 -i snps-chr1.bed| bedtools sort > sort-sub-snps-chr1.bed
bedtools sort -i hg19-kc.bed > sort-hg19-kc.bed
bedtools closest -d -t first -a sort-sub-snps-chr1.bed -b sort-hg19-kc.bed
#returns this
#chr1	3810505	3810506	rs78397137	0	+	chr1	3805696	3816836ENST00000361605.4_7	0
#chr1	11638083	11638084	rs6698664	0	+	chr1	11653741	11655507	ENST00000793460.1_2	15658
#chr1	11839540	11839541	rs200540772	0	+	chr1	11822249	11849642	ENST00000688073.1_7	0
#chr1	19020850	19020851	rs71645417	0	+	chr1	18957339	19075360	ENST00000420770.7_4	0
#chr1	19821839	19821840	rs2088825	0	+	chr1	19823503	19890741	ENST00000816783.1_2	1664
#chr1	20821533	20821534	rs74720529	0	+	chr1	20825940	20834644	ENST00000264198.5_7	4407
#chr1	22371064	22371065	rs10917130	0	+	chr1	22351634	22418052	ENST00000695855.1_5	0
#chr1	36733538	36733539	rs12726228	0	+	chr1	36690043	36770958	ENST00000354618.10_6	0
#chr1	51041899	51041900	rs77222361	0	+	chr1	50902699	51425939	ENST00000396153.7_8	0
#chr1	55741406	55741407	rs572651962	0	+	chr1	55683317	55790364	ENST00000643232.1_3	0
#chr1	62606299	62606300	rs12072694	0	+	chr1	62208151	62629587	ENST00000642238.2_5	0
#chr1	65318583	65318584	rs188698	0	-	chr1	65298911	65432232	ENST00000342505.5_11	0
#chr1	83638833	83638834	rs9429360	0	+	chr1	83368865	83632498	ENST00000452901.5_3	6336
#chr1	156101548	156101549	rs2485668	0	-	chr1	156084501	156109872	ENST00000368300.9_4	0
#chr1	164976172	164976173	rs11325393	0	+	chr1	164953138	164953229	ENST00000390797.1	22944
#chr1	174840899	174840900	rs1883139	0	-	chr1	174128657	174964445	ENST00000681986.1_7	0
#chr1	174951356	174951357	rs2285209	0	-	chr1	174128657	174964445	ENST00000681986.1_7	0
#chr1	189602916	189602917	rs6672054	0	+	chr1	189537458	189714982	ENST00000758530.1_2	0
#chr1	201437831	201437832	rs35383942	0	+	chr1	201433405	201438316	ENST00000367311.5_7	0
#chr1	247118389	247118390	rs61852577	0	+	chr1	247108848	247242038	ENST00000465049.6_8	0

#14 of 20 SNPs are inside of a gene
#of the other 6, the distances rnge from the thousands of nucleotides to the 10s of thousands of nucleotides